import{at as e,a as n,s as t,r,D as o,o as s,au as u,av as c,R as l,I as h,K as d,b as p,d as f,aw as C,Z as v,n as _,q as y,ao as m,U as g,e as U,i as E,k as $,G as w,J as M,l as T,a4 as N,ax as P,ay as D,az as O,aA as H,B as b,H as x,N as I,aB as A,j as L,aC as R,an as F,aq as k}from"./_/Wnxi7MtC.js";import{ak as S,al as q,am as z,an as Q,ao as K,ap as j,aq as B,ar as G,as as V,at as W,au as X,av as Z,n as Y,k as J,aw as ee}from"./_/1FmaOF00.js";import{f as ne,v as te,A as re,m as ae,I as oe,U as ie,g as se,L as ue,T as ce,H as le}from"./_/G1o6m-5n.js";import{t as he}from"./_/VEqLCKc1.js";import"./_/KlDdEvEx.js";var de=function(e){function a(){var n=null!==e&&e.apply(this,arguments)||this;return n._channels=new Map,n._enteredChannelUrls=[],n}return n(a,e),Object.defineProperty(a.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map((function(n){return e._channels.get(n)})).filter((function(e){return!!e}))},enumerable:!1,configurable:!0}),a.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e)},a.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e)},a.prototype.exit=function(e){var n=this._enteredChannelUrls.indexOf(e);n>=0&&this._enteredChannelUrls.splice(n,1)},a.prototype.exitAll=function(){this._enteredChannelUrls=[]},a.prototype.get=function(e){return r(this,void 0,void 0,(function(){return t(this,(function(n){return[2,this._channels.get(e)]}))}))},a.prototype.upsert=function(e){return r(this,void 0,void 0,(function(){var n,r=this;return t(this,(function(t){return n=[],e.forEach((function(e){if(r._channels.has(e.url)){var t=r._channels.get(e.url);Object.assign(t,e),n.push(t)}else r._channels.set(e.url,e),n.push(e)})),[2,n]}))}))},a.prototype.remove=function(e){return r(this,void 0,void 0,(function(){return t(this,(function(n){return this._channels.delete(e),this.exit(e),[2]}))}))},a.prototype.clear=function(){return r(this,void 0,void 0,(function(){return t(this,(function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2]}))}))},a}(e),pe={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},fe=function(e){function t$1(n){var t=n.channelUrl,r=n.isInternalCall,o=e.call(this)||this;return o.method=s.GET,o.path="".concat(r?u:c,"/").concat(encodeURIComponent(t)),o}return n(t$1,e),t$1}(o),Ce=function(e){function t$1(n,t){var r=e.call(this,n,t)||this;return r.channel=new Oe(n,t),r}return n(t$1,e),t$1}(l),ve=function(e){function t$1(n){var t=this,r=n.channelUrl,o=n.coverUrlOrImage,u=n.name,l=n.data,C=n.customType,v=n.operatorUserIds,_=n.isEphemeral;return(t=e.call(this)||this).method=s.POST,t.path=c,t.params=f(p({channel_url:r,cover_url:h("string",o)?o:null,cover_file:d(o)?o:null,name:u,data:l,custom_type:C,operators:v,is_ephemeral:_})),t}return n(t$1,e),t$1}(o);!function(e){function t$1(n,t){var r=e.call(this,n,t)||this;return r.channel=new Oe(n,t),r}n(t$1,e)}(l);var _e=function(e){function t$1(n){var t=n.channelUrl;return e.call(this,{code:"ENTR",payload:{channel_url:t},ackRequired:!0})||this}return n(t$1,e),t$1}(C),ye=function(e){function t$1(n,t,r){var o,s,u=this;return u=e.call(this,n,"SYEV",r)||this,r.data&&(u.participantCount=null!==(o=r.data.participant_count)&&void 0!==o?o:0,u.user=new v(n,r.data),u.ts=null!==(s=r.data.edge_ts)&&void 0!==s?s:0),u}return n(t$1,e),t$1}(ne),me=function(e){function t$1(n){var t=n.channelUrl;return e.call(this,{code:"EXIT",payload:{channel_url:t},ackRequired:!0})||this}return n(t$1,e),t$1}(C),ge=function(e){function t$1(n,t,r){var o,s,u=this;return u=e.call(this,n,"EXIT",r)||this,r.data&&(u.participantCount=null!==(o=r.data.participant_count)&&void 0!==o?o:0,u.user=new v(n,r.data),u.ts=null!==(s=r.data.edge_ts)&&void 0!==s?s:0),u}return n(t$1,e),t$1}(ne),Ue={},Ee=function(e){function s$1(n,o){var s=e.call(this,n,_(_({},o),{channelType:y.OPEN}))||this;return s.subscribeChannelEvent=m,s.unsubscribeChannelEvent=m,s.refreshChannel=function(){return r(s,void 0,void 0,(function(){return t(this,(function(e){return[2,m()]}))}))},s._openChannelCache=new de(n),s._openChannelHandlers=new Map,s._dispatcher.on((function(e){var n,t;if(e instanceof g)s._handleEvent(e).catch((function(e){if(U(e)&&"foreground"===s._sdkState.appState)throw e}));else if(e instanceof E&&e.stateType===$.CONNECTED){var r=s._openChannelCache.enteredChannels;try{for(var o=w(r),u=o.next();!u.done;u=o.next())u.value.enter()}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}}})),Ue[n]||(Ue[n]=s),s}return n(s$1,e),s$1.of=function(e){return Ue[e]},s$1.prototype.buildOpenChannelFromSerializedData=function(e){var n=M(e);return new Oe(this._iid,Oe.payloadify(n))},s$1.prototype.getChannelFromCache=function(e){var n;return r(this,void 0,void 0,(function(){return t(this,(function(t){switch(t.label){case 0:return[4,this._openChannelCache.get(e)];case 1:return[2,null!==(n=t.sent())&&void 0!==n?n:null]}}))}))},s$1.prototype.upsertChannelsToCache=function(e){return r(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,this._openChannelCache.upsert(e)];case 1:return[2,n.sent()]}}))}))},s$1.prototype.removeChannelsFromCache=function(e){return r(this,void 0,void 0,(function(){var n,r,o,s,u,c;return t(this,(function(t){switch(t.label){case 0:t.trys.push([0,5,6,7]),n=w(e),r=n.next(),t.label=1;case 1:return r.done?[3,4]:(o=r.value,[4,this._openChannelCache.remove(o)]);case 2:t.sent(),t.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return s=t.sent(),u={error:s},[3,7];case 6:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}return[7];case 7:return[2]}}))}))},s$1.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url)},s$1.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url)},s$1.prototype._handleEvent=function(e){return r(this,void 0,void 0,(function(){var n,o,s,u,c,l,h,d,p,f,C,v,_,m,g,E,$,M,b,x,I,A,L,R,F,k,Y,J,ee,te,he,de,pe,fe,Ce,ve,_e,me,Ue,Ee,$e,we,Me,Te,Ne,Pe,De,Oe,He,be,xe,Ie,Ae,Le,Re,Fe,ke,Se,qe,ze,Qe,Ke,je,Be,Ge,Ve,We,Xe,Ze=this;return t(this,(function(Ye){switch(Ye.label){case 0:switch(Ye.trys.push([0,57,,58]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"MRCT":return[3,10];case"MTHD":return[3,13];case"MCNT":return[3,16];case"PEDI":return[3,27];case"VOTE":return[3,30];case"SYEV":return[3,33]}return[3,56];case 1:return u=null,"MESG"===e.code?u=e.as(X):"FILE"===e.code?u=e.as(Z):"ADMM"!==e.code&&"BRDM"!=e.code||(u=e.as(le)),u?(n=u.message,o=u.isMentioned,n.channelType!==y.OPEN?[3,3]:[4,this.getChannel(n.channelUrl,!0)]):[3,3];case 2:s=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){var e,r,u,c,l;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),r=e.next();!r.done;r=e.next())u=r.value,this._openChannelCache.isEnteredChannel(s.url)&&(u.onMessageReceived&&u.onMessageReceived(s,n),o&&u.onMentionReceived&&u.onMentionReceived(s,n))}catch(e){c={error:e}}finally{try{r&&!r.done&&(l=e.return)&&l.call(e)}finally{if(c)throw c.error}}return[2]}))}))})),Ye.label=3;case 3:return[3,56];case 4:return u=null,"MEDI"===e.code?u=e.as(V):"FEDI"===e.code?u=e.as(W):"AEDI"===e.code&&(u=e.as(ce)),u?(c=u.message,l=u.mentionCountChange,c.channelType!==y.OPEN?[3,6]:[4,this.getChannel(c.channelUrl,!0)]):[3,6];case 5:h=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())r=n.value,this._openChannelCache.isEnteredChannel(h.url)&&(r.onMessageUpdated&&r.onMessageUpdated(h,c),l>0&&r.onMentionReceived&&r.onMentionReceived(h,c))}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))})),Ye.label=6;case 6:return[3,56];case 7:return d=e.as(H),he=d.channelUrl,de=d.channelType,p=d.messageId,de!==y.OPEN?[3,9]:[4,this.getChannel(he,!0)];case 8:f=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())r=n.value,this._openChannelCache.isEnteredChannel(f.url)&&r.onMessageDeleted&&r.onMessageDeleted(f,p)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))})),Ye.label=9;case 9:return[3,56];case 10:return C=e.as(ue),he=C.channelUrl,de=C.channelType,v=C.event,de!==y.OPEN?[3,12]:[4,this.getChannel(he,!0)];case 11:_=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())r=n.value,this._openChannelCache.isEnteredChannel(_.url)&&r.onReactionUpdated&&r.onReactionUpdated(_,v)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))})),Ye.label=12;case 12:return[3,56];case 13:return(m=e.as(se).event).channelType!==y.OPEN?[3,15]:[4,this.getChannel(m.channelUrl,!0)];case 14:g=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())r=n.value,this._openChannelCache.isEnteredChannel(g.url)&&r.onThreadInfoUpdated&&r.onThreadInfoUpdated(g,m)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))})),Ye.label=15;case 15:return[3,56];case 16:E=e.as(ie).openChannelMemberCounts,$=[],Ye.label=17;case 17:Ye.trys.push([17,22,23,24]),M=w(E),b=M.next(),Ye.label=18;case 18:return b.done?[3,21]:(x=b.value,he=x.channelUrl,$e=x.participantCount,I=x.updatedAt,[4,this.getChannelFromCache(he)]);case 19:(A=Ye.sent())&&A._updateParticipantCount($e,I)&&$.push(A),Ye.label=20;case 20:return b=M.next(),[3,18];case 21:return[3,24];case 22:return L=Ye.sent(),We={error:L},[3,24];case 23:try{b&&!b.done&&(Xe=M.return)&&Xe.call(M)}finally{if(We)throw We.error}return[7];case 24:return $.length>0?[4,this.upsertChannelsToCache($)]:[3,26];case 25:R=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())(r=n.value).onChannelMemberCountChanged&&r.onChannelMemberCountChanged(R)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))})),Ye.label=26;case 26:return[3,56];case 27:return F=e.as(oe),k=F.event,Y=F.status,he=F.channelUrl,de=F.channelType,he&&de===y.OPEN?[4,this.getChannel(he,!0)]:[3,29];case 28:J=Ye.sent(),this._dispatcher.dispatch(new D({event:k,source:N.EVENT_POLL_UPDATED})),T(Y===O?function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())(r=n.value).onPollDeleted&&r.onPollDeleted(J,k.pollId)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))}:function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())(r=n.value).onPollUpdated&&r.onPollUpdated(J,k)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))}),Ye.label=29;case 29:return[3,56];case 30:return ee=e.as(G),te=ee.event,he=ee.channelUrl,de=ee.channelType,he&&de===y.OPEN?[4,this.getChannel(he,!0)]:[3,32];case 31:pe=Ye.sent(),this._dispatcher.dispatch(new P({event:te,source:N.EVENT_POLL_VOTED})),T((function(){return r(Ze,void 0,void 0,(function(){var e,n,r,o,s;return t(this,(function(t){try{for(e=w(this._openChannelHandlers.values()),n=e.next();!n.done;n=e.next())(r=n.value).onPollVoted&&r.onPollVoted(pe,te)}catch(e){o={error:e}}finally{try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(o)throw o.error}}return[2]}))}))})),Ye.label=32;case 32:return[3,56];case 33:if(!(fe=e.as(ne).event).isOpenChannelEvent)return[3,55];switch(fe.category){case re.CHANNEL_ENTER:return[3,34];case re.CHANNEL_EXIT:return[3,36];case re.CHANNEL_OPERATOR_UPDATE:return[3,38];case re.USER_CHANNEL_MUTE:case re.USER_CHANNEL_UNMUTE:return[3,40];case re.USER_CHANNEL_BAN:case re.USER_CHANNEL_UNBAN:return[3,42];case re.CHANNEL_FREEZE:case re.CHANNEL_UNFREEZE:return[3,44];case re.CHANNEL_DELETED:return[3,46];case re.CHANNEL_PROP_CHANGED:return[3,49];case re.CHANNEL_META_DATA_CHANGED:return[3,51];case re.CHANNEL_META_COUNTERS_CHANGED:return[3,53]}return[3,55];case 34:return[4,this.getChannel(fe.channelUrl,!0)];case 35:return Ce=Ye.sent(),ve=e.as(ye),$e=ve.participantCount,_e=ve.user,me=Ce._updateParticipantCount($e,fe.ts),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserEntered&&e.onUserEntered(Ce,_e),me&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(Ce)})),[2]}))}))})),[3,55];case 36:return[4,this.getChannel(fe.channelUrl,!0)];case 37:return Ue=Ye.sent(),Ee=e.as(ge),$e=Ee.participantCount,we=Ee.user,Me=Ue._updateParticipantCount($e,fe.ts),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserExited&&e.onUserExited(Ue,we),Me&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(Ue)})),[2]}))}))})),[3,55];case 38:return[4,this.getChannel(fe.channelUrl,!0)];case 39:return Te=Ye.sent(),Ne=e.as(ae).operators,Te.operators=Ne,this.upsertChannelsToCache([Te]),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(Te,Ne)})),[2]}))}))})),[3,55];case 40:return[4,this.getChannel(fe.channelUrl,!0)];case 41:return Pe=Ye.sent(),De=fe.category===re.USER_CHANNEL_MUTE,Oe=e.as(De?j:B).user,T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){De?e.onUserMuted&&e.onUserMuted(Pe,Oe):e.onUserUnmuted&&e.onUserUnmuted(Pe,Oe)})),[2]}))}))})),[3,55];case 42:return[4,this.getChannel(fe.channelUrl,!0)];case 43:return He=Ye.sent(),be=fe.category===re.USER_CHANNEL_BAN,xe=e.as(be?Q:K).user,T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){be?e.onUserBanned&&e.onUserBanned(He,xe):e.onUserUnbanned&&e.onUserUnbanned(He,xe)})),[2]}))}))})),[3,55];case 44:return[4,this.getChannel(fe.channelUrl,!0)];case 45:return Ie=Ye.sent(),Ae=e.as(z).freeze,Ie.isFrozen=Ae,this.upsertChannelsToCache([Ie]),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){Ae?e.onChannelFrozen&&e.onChannelFrozen(Ie):e.onChannelUnfrozen&&e.onChannelUnfrozen(Ie)})),[2]}))}))})),[3,55];case 46:return[4,this.getChannel(fe.channelUrl,!0)];case 47:return Le=Ye.sent(),[4,this.removeChannelsFromCache([Le.url])];case 48:return Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(Le.url,Le.channelType)})),[2]}))}))})),[3,55];case 49:return[4,this.getChannelWithoutCache(fe.channelUrl,!0)];case 50:return Re=Ye.sent(),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(Re)})),[2]}))}))})),[3,55];case 51:return[4,this.getChannel(fe.channelUrl,!0)];case 52:return Fe=Ye.sent(),ke=e.as(q),Se=ke.created,qe=ke.updated,ze=ke.deleted,Se&&Fe._upsertCachedMetaData(Se,fe.ts),qe&&Fe._upsertCachedMetaData(qe,fe.ts),ze&&Fe._removeFromCachedMetaData(ze,fe.ts),T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){Se&&e.onMetaDataCreated&&e.onMetaDataCreated(Fe,Se),qe&&e.onMetaDataUpdated&&e.onMetaDataUpdated(Fe,qe),ze&&e.onMetaDataDeleted&&e.onMetaDataDeleted(Fe,ze)})),[2]}))}))})),[3,55];case 53:return[4,this.getChannel(fe.channelUrl,!0)];case 54:return Qe=Ye.sent(),Ke=e.as(S),je=Ke.created,Be=Ke.updated,Ge=Ke.deleted,T((function(){return r(Ze,void 0,void 0,(function(){return t(this,(function(e){return this._openChannelHandlers.forEach((function(e){je&&e.onMetaCounterCreated&&e.onMetaCounterCreated(Qe,je),Be&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(Qe,Be),Ge&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(Qe,Ge)})),[2]}))}))})),[3,55];case 55:return[3,56];case 56:return[3,58];case 57:if(Ve=Ye.sent(),U(Ve))throw Ve;return[3,58];case 58:return[2]}}))}))},s$1.prototype.addHandler=function(e,n){this._openChannelHandlers.set(e,n)},s$1.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e)},s$1.prototype.clearHandler=function(){this._openChannelHandlers.clear()},s$1.prototype.getChannel=function(e,n){return r(this,void 0,void 0,(function(){var n;return t(this,(function(t){switch(t.label){case 0:x(h("string",e)).throw(b.invalidParameters),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(n=t.sent())?[2,n]:[3,4];case 3:return t.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e)];case 5:return[2,t.sent()]}}))}))},s$1.prototype.getChannelWithoutCache=function(e,n){return void 0===n&&(n=!1),r(this,void 0,void 0,(function(){var r,o,s;return t(this,(function(t){switch(t.label){case 0:return x(h("string",e)).throw(b.invalidParameters),r=new fe({channelUrl:e,isInternalCall:n}),[4,this._requestQueue.send(r)];case 1:return o=t.sent(),s=o.as(Ce).channel,[4,this.upsertChannelsToCache([s])];case 2:return[2,t.sent()[0]]}}))}))},s$1.prototype.createChannel=function(e){return r(this,void 0,void 0,(function(){var n,r,o,s;return t(this,(function(t){switch(t.label){case 0:return n=_(_({},pe),e),x(function(e){return I("string",e.operatorUserIds,!0)&&(h("string",e.coverUrlOrImage,!0)||d(e.coverUrlOrImage,!0))&&h("string",e.name,!0)&&h("string",e.data,!0)&&h("string",e.customType,!0)&&(h("string",e.channelUrl)&&/^\w+$/.test(e.channelUrl)||null===e.channelUrl||void 0===e.channelUrl)&&h("boolean",e.isEphemeral,!0)}(n)).throw(b.invalidParameters),r=new ve(n),[4,this._requestQueue.send(r)];case 1:return o=t.sent(),s=o.as(Ce).channel,this.upsertChannelsToCache([s]),[2,s]}}))}))},s$1}(te),$e={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},we=function(e){function t$1(n){var t=this,r=n.channelUrl,o=n.token,u=n.limit;return(t=e.call(this)||this).method=s.GET,t.path="".concat(c,"/").concat(encodeURIComponent(r),"/participants"),t.params={token:o,limit:u},t}return n(t$1,e),t$1}(o),Me=function(e){function t$1(n,t){var r=e.call(this,n,t)||this;r.participants=[];var o=t.next,s=t.participants;return r.token=o,r.participants=s.map((function(e){return new Y(n,e)})),r}return n(t$1,e),t$1}(l),Te=function(e){function a(n,t,r){return e.call(this,n,t,y.OPEN,r)||this}return n(a,e),a.prototype._validate=function(){return e.prototype._validate.call(this)},a.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,n,r,o,s,u;return t(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=L.of(this._iid).requestQueue,n=new we(_(_({},this),{token:this._token})),[4,e.send(n)]):[3,2]:[3,5];case 1:return r=t.sent(),o=r.as(Me),s=o.participants,u=o.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,s];case 2:return[2,[]];case 3:throw b.queryInProgress;case 4:return[3,6];case 5:throw b.invalidParameters;case 6:return[2]}}))}))},a}(A),Ne=function(e){function t$1(n){var t=this,r=n.channelUrl,o=n.coverUrlOrImage,u=n.name,l=n.data,C=n.customType,v=n.operatorUserIds;return(t=e.call(this)||this).method=s.PUT,t.path="".concat(c,"/").concat(encodeURIComponent(r)),t.params=f(p({cover_url:h("string",o)?o:null,cover_file:d(o)?o:null,name:u,data:l,custom_type:C,operators:v})),t}return n(t$1,e),t$1}(o),Pe=function(e){function t$1(n,t){var r=e.call(this,n,t)||this;return r.channel=new Oe(n,t),r}return n(t$1,e),t$1}(l),De=function(e){function t$1(n){var t=this,r=n.channelUrl;return(t=e.call(this)||this).method=s.DELETE,t.path="".concat(c,"/").concat(encodeURIComponent(r)),t}return n(t$1,e),t$1}(o);!function(e){function t$1(n,t){return e.call(this,n,t)||this}n(t$1,e)}(l);var Oe=function(e){function s$1(n,t){var r,o=this;return(o=e.call(this,n,t)||this)._lastParticipantCountUpdated=0,o.participantCount=0,o.operators=[],o.channelType=y.OPEN,o.participantCount=null!==(r=t.participant_count)&&void 0!==r?r:0,o.operators=Array.isArray(t.operators)?t.operators.map((function(e){return new v(n,e)})):[],o}return n(s$1,e),s$1.payloadify=function(e){return f(p(_(_({},J.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map((function(e){return v.payloadify(e)}))})))},s$1.prototype.serialize=function(){return R(this)},s$1.prototype.isOperator=function(e){return e instanceof v?this.isOperator(e.userId):this.operators.some((function(n){return n.userId===e}))},s$1.prototype._updateParticipantCount=function(e,n){return n>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=n,!0)},s$1.prototype.createParticipantListQuery=function(e){return new Te(this._iid,this.url,e)},s$1.prototype.refresh=function(){return r(this,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return[4,Ee.of(this._iid).getChannelWithoutCache(this.url)];case 1:return[2,e.sent()]}}))}))},s$1.prototype.enter=function(){return r(this,void 0,void 0,(function(){var e,n,r,o,s,u;return t(this,(function(t){switch(t.label){case 0:return e=L.of(this._iid).requestQueue,n=new _e({channelUrl:this.url}),[4,e.send(n)];case 1:return r=t.sent(),o=r.as(ye),s=o.participantCount,u=o.ts,this._updateParticipantCount(s,u),Ee.of(this._iid).setEnteredToCache(this),[2]}}))}))},s$1.prototype.exit=function(){return r(this,void 0,void 0,(function(){var e,n,r,o,s,u;return t(this,(function(t){switch(t.label){case 0:return e=L.of(this._iid).requestQueue,n=new me({channelUrl:this.url}),[4,e.send(n)];case 1:return r=t.sent(),o=r.as(ge),s=o.participantCount,u=o.ts,this._updateParticipantCount(s,u),Ee.of(this._iid).setExitedToCache(this),ee.of(this._iid).fileMessageQueue.cancel(this),[2]}}))}))},s$1.prototype.updateChannel=function(e){return r(this,void 0,void 0,(function(){var n,r,o,s,u;return t(this,(function(t){switch(t.label){case 0:return n=_(_({},$e),e),x(function(e){return I("string",e.operatorUserIds,!0)&&(h("string",e.coverUrlOrImage,!0)||d(e.coverUrlOrImage,!0))&&h("string",e.name,!0)&&h("string",e.data,!0)&&h("string",e.customType,!0)}(n)).throw(b.invalidParameters),r=L.of(this._iid).requestQueue,o=new Ne(_({channelUrl:this.url},n)),[4,r.send(o)];case 1:return s=t.sent(),u=s.as(Pe).channel,this._update(u),[4,Ee.of(this._iid).upsertChannelsToCache([u])];case 2:return t.sent(),[2,this]}}))}))},s$1.prototype.updateChannelWithOperatorUserIds=function(e,n,o,s,u){return r(this,void 0,void 0,(function(){var r;return t(this,(function(t){return r=_(_({},$e),{name:e,coverUrlOrImage:n,data:o,operatorUserIds:s,customType:u}),[2,this.updateChannel(r)]}))}))},s$1.prototype.delete=function(){return r(this,void 0,void 0,(function(){var e,n;return t(this,(function(t){switch(t.label){case 0:return e=L.of(this._iid).requestQueue,n=new De({channelUrl:this.url}),[4,e.send(n)];case 1:return t.sent(),[4,Ee.of(this._iid).removeChannelsFromCache([this.url])];case 2:return t.sent(),[2]}}))}))},s$1.prototype.sendUserMessage=function(n){return x(!n.isPinnedMessage).throw(b.notSupportedError),e.prototype.sendUserMessage.call(this,n)},s$1.prototype.sendFileMessage=function(n){return x(!n.isPinnedMessage).throw(b.notSupportedError),e.prototype.sendFileMessage.call(this,n)},s$1}(J),He=function(e){function t$1(n){void 0===n&&(n={});var t=e.call(this)||this;return Object.keys(n).forEach((function(e){t.hasOwnProperty(e)&&(t[e]=n[e])})),t}return n(t$1,e),t$1}(function(e){function t$1(){var n=null!==e&&e.apply(this,arguments)||this;return n.onUserEntered=m,n.onUserExited=m,n.onChannelParticipantCountChanged=m,n.onPollUpdated=m,n.onPollVoted=m,n.onPollDeleted=m,n}return n(t$1,e),t$1}(he)),be=function(e){function t$1(n){var t=this,r=n.token,o=n.limit,u=n.nameKeyword,l=n.urlKeyword,h=n.customTypes,d=n.includeFrozen,p=n.includeMetaData;return(t=e.call(this)||this).method=s.GET,t.path=c,t.params=f({token:r,limit:o,name_contains:u,url_contains:l,custom_types:h,show_frozen:d,show_metadata:p}),t}return n(t$1,e),t$1}(o),xe=function(e){function t$1(n,t){var r=e.call(this,n,t)||this;r.channels=[];var o=t.next,s=t.channels,u=t.ts;return r.token=o,s&&s.length>0&&(r.channels=s.map((function(e){return new Oe(n,e)}))),r.ts="number"==typeof u?u:null,r}return n(t$1,e),t$1}(l),Ie=function(e){function i(n,t){var r,o,s,u,c,l=this;return(l=e.call(this,n,t)||this).includeFrozen=!0,l.includeMetaData=!0,l.nameKeyword=null,l.urlKeyword=null,l.customTypes=null,l.includeFrozen=null===(r=t.includeFrozen)||void 0===r||r,l.includeMetaData=null===(o=t.includeMetaData)||void 0===o||o,l.nameKeyword=null!==(s=t.nameKeyword)&&void 0!==s?s:null,l.urlKeyword=null!==(u=t.urlKeyword)&&void 0!==u?u:null,l.customTypes=null!==(c=t.customTypes)&&void 0!==c?c:null,l}return n(i,e),i.prototype._validate=function(){return e.prototype._validate.call(this)&&h("boolean",this.includeFrozen)&&h("boolean",this.includeMetaData)&&h("string",this.nameKeyword,!0)&&h("string",this.urlKeyword,!0)&&I("string",this.customTypes,!0)},i.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,n,r,o,s,u;return t(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=L.of(this._iid).requestQueue,n=new be(p(_(_({},this),{token:this._token}))),[4,e.send(n)]):[3,3]:[3,6];case 1:return r=t.sent(),o=r.as(xe),s=o.channels,u=o.token,this._token=u,this._hasNext=!!u,[4,Ee.of(this._iid).upsertChannelsToCache(s)];case 2:return t.sent(),this._isLoading=!1,[2,s];case 3:return[2,[]];case 4:throw b.queryInProgress;case 5:return[3,7];case 6:throw b.invalidParameters;case 7:return[2]}}))}))},i}(F),Ae=function(e){function a(){var n=null!==e&&e.apply(this,arguments)||this;return n.name="openChannel",n}return n(a,e),a.prototype.init=function(n,t){var r=t.sdkState,o=t.dispatcher,s=t.sessionManager,u=t.requestQueue,c=t.logger,l=t.onlineDetector,h=t.cacheContext;e.prototype.init.call(this,n,{sdkState:r,dispatcher:o,sessionManager:s,requestQueue:u,logger:c,onlineDetector:l,cacheContext:h}),this._manager=new Ee(n,{sdkState:r,dispatcher:o,requestQueue:u,logger:c,cacheContext:h,sessionManager:s})},a.prototype.createOpenChannelListQuery=function(e){return void 0===e&&(e={}),new Ie(this._iid,e)},a.prototype.addOpenChannelHandler=function(e,n){this._manager.addHandler(e,n)},a.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e)},a.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler()},a.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e)},a.prototype.getChannel=function(e){return r(this,void 0,void 0,(function(){return t(this,(function(n){return[2,this._manager.getChannel(e)]}))}))},a.prototype.getChannelWithoutCache=function(e){return r(this,void 0,void 0,(function(){return t(this,(function(n){return[2,this._manager.getChannelWithoutCache(e)]}))}))},a.prototype.createChannel=function(e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){return t(this,(function(n){return[2,this._manager.createChannel(e)]}))}))},a.prototype.createChannelWithOperatorUserIds=function(e,n,o,s,u){return r(this,void 0,void 0,(function(){var r;return t(this,(function(t){return(r=_({},pe)).name=e,r.coverUrlOrImage=n,r.data=o,r.operatorUserIds=s,r.customType=u,[2,this._manager.createChannel(r)]}))}))},a}(k);export{Oe as OpenChannel,He as OpenChannelHandler,Ie as OpenChannelListQuery,Ae as OpenChannelModule,Te as ParticipantListQuery};

